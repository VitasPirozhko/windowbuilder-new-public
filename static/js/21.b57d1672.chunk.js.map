{"version":3,"sources":["components/CalcOrder/ClientOfDealer/styles.js","components/CalcOrder/ClientOfDealer/connect.js","components/CalcOrder/ClientOfDealer/ClientOfDealer.js","components/CalcOrder/ClientOfDealer/index.js","../node_modules/@material-ui/icons/Print.js","../node_modules/metadata-react/common/MDNRComponent.js"],"names":["withStyles","theme","entered","minHeight","secondary","marginTop","spacing","groupTitle","fontWeight","listitem","paddingTop","paddingBottom","compose","connect","state","props","handleCalck","Promise","resolve","handleCancel","handlers","handleIfaceState","component","name","value","ClientOfDealer","Component","constructor","context","super","handleOk","data","obj","meta","fake_obj","dialog","this","struct","items","find","v","cond_value","individual_legal","has","fld","some","mf","fields","mandatory","setState","msg","title","$p","mandatory_title","text","mandatory_field","replace","synonym","cmd","join","handleErrClose","ref","_mgr","bind","by_ref","metadata","form","split","Object","keys","_metadata","utils","__define","get","fetch_type","indexOf","set","_obj","_meta","handleValueChange","_fld","event","target","forceUpdate","render","Dialog","open","initFullScreen","large","onClose","actions","Button","key","onClick","color","renderItems","call","_interopRequireDefault","require","defineProperty","exports","default","_react","_default","createElement","d","MDNRComponent","MComponent","shouldComponentUpdate","res","ltitle","handleManagerChange","dnr","ignoreTitle","width","height","columns","parseInt","frameRect","columnsWidth","reduce","sum","val","_width","contextTypes","PropTypes","object","customComponents"],"mappings":"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","file":"static/js/21.b57d1672.chunk.js","sourcesContent":["/**\r\n * ### Карточка покупателя\r\n * стили оформления\r\n *\r\n * Created by Evgeniy Malyarov on 14.03.2018.\r\n */\r\n\r\nimport {withStyles} from '@material-ui/styles';\r\n\r\nconst styles = theme => ({\r\n  entered: {\r\n    minHeight: 120,\r\n  },\r\n  secondary: {\r\n    marginTop: -theme.spacing(1.5),\r\n  },\r\n  groupTitle: {\r\n    fontWeight: 'bold',\r\n  },\r\n  listitem: {\r\n    paddingTop: theme.spacing(),\r\n    paddingBottom: theme.spacing(),\r\n  }\r\n});\r\n\r\nexport default withStyles(styles);\r\n","/**\r\n * ### Карточка покупателя\r\n * обработчики событий и модификаторы данных\r\n *\r\n * Created by Evgeniy Malyarov on 13.11.2017.\r\n */\r\n\r\nimport {connect} from 'react-redux';\r\nimport withStyles from './styles';\r\nimport {compose} from 'redux';\r\n\r\n\r\nfunction mapStateToProps(state, props) {\r\n  return {\r\n    handleCalck() {\r\n      //dp.calc_order.production.sync_grid(props.dialog.wnd.elmnts.grids.production);\r\n      return Promise.resolve();\r\n    },\r\n    handleCancel() {\r\n      props.handlers.handleIfaceState({\r\n        component: 'DataObjPage',\r\n        name: 'dialog',\r\n        value: null,\r\n      });\r\n    }\r\n  };\r\n}\r\n\r\n// function mapDispatchToProps(dispatch) {\r\n//   return {};\r\n// }\r\n\r\nexport default compose(\r\n  withStyles,\r\n  connect(mapStateToProps /*, mapDispatchToProps */),\r\n);\r\n","/**\r\n * ### Карточка покупателя\r\n * каркас компонента - визуальная глупая часть\r\n *\r\n * Created by Evgeniy Malyarov on 13.11.2017.\r\n */\r\n\r\nimport React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from 'metadata-react/App/Dialog';\r\nimport {renderItems} from 'metadata-react/FrmObj/DataObj';\r\nimport connect from './connect';\r\n\r\nclass ClientOfDealer extends Component {\r\n\r\n  constructor(props, context) {\r\n    super(props, context);\r\n    const {handleCancel, handleCalck, dialog: {ref, cmd, _mgr}} = props;\r\n    this.handleCancel = handleCancel.bind(this);\r\n    this.handleCalck = handleCalck.bind(this);\r\n\r\n    this.obj = _mgr.by_ref[ref];\r\n    const meta = this.meta = _mgr.metadata().form[cmd];\r\n    const data = this.data = this.obj[cmd].split('\\u00A0');\r\n\r\n    // виртуальные данные\r\n    const fields = Object.keys(meta.fields);\r\n    this.fake_obj = {\r\n      _metadata(fld) {\r\n        return fld ? meta.fields[fld] : meta;\r\n      },\r\n\r\n      get _manager() {\r\n        return _mgr;\r\n      },\r\n\r\n    };\r\n    const {utils} = $p;\r\n    for (const fld of fields) {\r\n      this.fake_obj.__define(fld, {\r\n        get() {\r\n          return utils.fetch_type(data[fields.indexOf(fld)], meta.fields[fld]);\r\n        },\r\n        set(v) {\r\n          data[fields.indexOf(fld)] = v;\r\n        }\r\n      });\r\n    }\r\n\r\n    this.state = {\r\n      _obj: this.fake_obj,\r\n      _meta: meta,\r\n      msg: null\r\n    };\r\n\r\n  }\r\n\r\n  handleOk = () => {\r\n    const {data, obj, meta, fake_obj, props: {dialog}} = this;\r\n\r\n    // если не указаны обязательные реквизиты\r\n    const struct = {\r\n      items: meta.obj.items.find((v) => v.cond_value === fake_obj.individual_legal),\r\n      has(fld, items) {\r\n        if(!items) {\r\n          items = this.items;\r\n        }\r\n        if(!items) {\r\n          return true;\r\n        }\r\n        if(items.items) {\r\n          items = items.items;\r\n        }\r\n        return items.some((v) => {\r\n          if(v.fld === fld) {\r\n            return true;\r\n          }\r\n          if(v.items) {\r\n            return this.has(fld, v.items);\r\n          }\r\n        });\r\n      }\r\n    };\r\n    for (var mf in meta.fields){\r\n      if (meta.fields[mf].mandatory && !fake_obj[mf] && struct.has(mf)) {\r\n        this.setState({msg: {\r\n          title: $p.msg.mandatory_title,\r\n          text: $p.msg.mandatory_field.replace(\"%1\", meta.fields[mf].synonym)\r\n        }});\r\n        return;\r\n      }\r\n    }\r\n\r\n    obj[dialog.cmd] = data.join('\\u00A0');\r\n    this.handleCancel();\r\n  };\r\n\r\n  handleErrClose = () => {\r\n    this.setState({msg: null});\r\n  };\r\n\r\n  handleValueChange(_fld) {\r\n    return (event, value) => {\r\n      const {state: {_obj}} = this;\r\n      //const old_value = _obj[_fld];\r\n      _obj[_fld] = (value || (event && event.target ? event.target.value : ''));\r\n      this.forceUpdate();\r\n    };\r\n  }\r\n\r\n  render() {\r\n\r\n    const {handleCancel, handleOk, handleErrClose, meta, state: {msg}} = this;\r\n\r\n    return <Dialog\r\n      open\r\n      initFullScreen\r\n      large\r\n      title=\"Реквизиты клиента\"\r\n      onClose={handleCancel}\r\n      actions={[\r\n        <Button key=\"ok\" onClick={handleOk} color=\"primary\">Записать и закрыть</Button>,\r\n        <Button key=\"cancel\" onClick={handleCancel} color=\"primary\">Закрыть</Button>\r\n      ]}\r\n    >\r\n      {renderItems.call(this, meta.obj.items)}\r\n      {msg && <Dialog\r\n        open\r\n        title={msg.title}\r\n        onClose={handleErrClose}\r\n        actions={[\r\n          <Button key=\"ok\" onClick={handleErrClose} color=\"primary\">Ок</Button>,\r\n        ]}\r\n      >\r\n        {msg.text || msg}\r\n      </Dialog>}\r\n    </Dialog>;\r\n\r\n  }\r\n}\r\n\r\nClientOfDealer.propTypes = {\r\n  dialog: PropTypes.object.isRequired,\r\n  handlers: PropTypes.object.isRequired,\r\n  handleCalck: PropTypes.func.isRequired,\r\n  handleCancel: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default connect(ClientOfDealer);\r\n","import ClientOfDealer from './ClientOfDealer';\r\n\r\nexport default ClientOfDealer;\r\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z\"\n}), 'Print');\n\nexports.default = _default;","/**\n * Компонент\n * - содержит свойство _mounted\n * - знает, размещен ли он в основном дереве react или во всплывающем окне\n * - устанавливает title основного раздела интерфейса\n *\n * Created 11.01.2017\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport MComponent from './MComponent';\nexport default class MDNRComponent extends MComponent {\n  shouldComponentUpdate({\n    _mgr,\n    _meta,\n    title,\n    handleIfaceState\n  }) {\n    let res = true;\n    const {\n      props,\n      ltitle,\n      context\n    } = this; // если изменился менеджер, ищем новые настройки компоновки\n\n    if (props._mgr !== _mgr && this.handleManagerChange) {\n      this.handleManagerChange({\n        _mgr,\n        _meta\n      });\n      res = false;\n    } // если мы не в диалоге, меняем заголовок приложения\n\n\n    if (!context.dnr && ltitle && title != ltitle && !props.ignoreTitle) {\n      handleIfaceState && handleIfaceState({\n        component: '',\n        name: 'title',\n        value: ltitle\n      });\n      res = false;\n    }\n\n    return res;\n  }\n\n  get sizes() {\n    let {\n      context: {\n        dnr\n      },\n      props: {\n        width,\n        height\n      },\n      state: {\n        columns\n      }\n    } = this;\n\n    if (!height) {\n      height = dnr && parseInt(dnr.frameRect.height) - 2;\n    }\n\n    if (!height || height < 320) {\n      height = 320;\n    }\n\n    if (!width) {\n      width = dnr && parseInt(dnr.frameRect.width);\n    }\n\n    if (!width || width < 480) {\n      width = 480;\n    } // горизонтальная прокрутка\n\n\n    return {\n      width,\n      height,\n      columnsWidth: columns ? columns.reduce((sum, val) => sum + val._width, 0) : width\n    };\n  }\n\n}\nMDNRComponent.contextTypes = {\n  dnr: PropTypes.object,\n  customComponents: PropTypes.object\n};"],"sourceRoot":""}