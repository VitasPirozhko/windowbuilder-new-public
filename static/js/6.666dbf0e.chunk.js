(this["webpackJsonpwindowbuilder-new"]=this["webpackJsonpwindowbuilder-new"]||[]).push([[6],{636:function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty,a=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),i=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)"undefined"!==typeof e[n]&&(r[n]=e[n]);return r};e.exports={arrayToObject:i,assign:function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var a=t[n],i=a.obj[a.prop],o=Object.keys(i),c=0;c<o.length;++c){var l=o[c],s=i[l];"object"===typeof s&&null!==s&&-1===r.indexOf(s)&&(t.push({obj:i,prop:l}),r.push(s))}return function(e){for(var t;e.length;){var r=e.pop();if(t=r.obj[r.prop],Array.isArray(t)){for(var n=[],a=0;a<t.length;++a)"undefined"!==typeof t[a]&&n.push(t[a]);r.obj[r.prop]=n}}return t}(t)},decode:function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},encode:function(e){if(0===e.length)return e;for(var t="string"===typeof e?e:String(e),r="",n=0;n<t.length;++n){var i=t.charCodeAt(n);45===i||46===i||95===i||126===i||i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122?r+=t.charAt(n):i<128?r+=a[i]:i<2048?r+=a[192|i>>6]+a[128|63&i]:i<55296||i>=57344?r+=a[224|i>>12]+a[128|i>>6&63]+a[128|63&i]:(n+=1,i=65536+((1023&i)<<10|1023&t.charCodeAt(n)),r+=a[240|i>>18]+a[128|i>>12&63]+a[128|i>>6&63]+a[128|63&i])}return r},isBuffer:function(e){return null!==e&&"undefined"!==typeof e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function e(t,r,a){if(!r)return t;if("object"!==typeof r){if(Array.isArray(t))t.push(r);else{if("object"!==typeof t)return[t,r];(a.plainObjects||a.allowPrototypes||!n.call(Object.prototype,r))&&(t[r]=!0)}return t}if("object"!==typeof t)return[t].concat(r);var o=t;return Array.isArray(t)&&!Array.isArray(r)&&(o=i(t,a)),Array.isArray(t)&&Array.isArray(r)?(r.forEach((function(r,i){n.call(t,i)?t[i]&&"object"===typeof t[i]?t[i]=e(t[i],r,a):t.push(r):t[i]=r})),t):Object.keys(r).reduce((function(t,i){var o=r[i];return n.call(t,i)?t[i]=e(t[i],o,a):t[i]=o,t}),o)}}},637:function(e,t,r){"use strict";var n=String.prototype.replace,a=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return n.call(e,a,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},672:function(e,t,r){"use strict";var n=r(673),a=r(674),i=r(637);e.exports={formats:i,parse:a,stringify:n}},673:function(e,t,r){"use strict";var n=r(636),a=r(637),i={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},o=Date.prototype.toISOString,c={delimiter:"&",encode:!0,encoder:n.encode,encodeValuesOnly:!1,serializeDate:function(e){return o.call(e)},skipNulls:!1,strictNullHandling:!1},l=function e(t,r,a,i,o,l,s,u,f,d,p,h){var y=t;if("function"===typeof s)y=s(r,y);else if(y instanceof Date)y=d(y);else if(null===y){if(i)return l&&!h?l(r,c.encoder):r;y=""}if("string"===typeof y||"number"===typeof y||"boolean"===typeof y||n.isBuffer(y))return l?[p(h?r:l(r,c.encoder))+"="+p(l(y,c.encoder))]:[p(r)+"="+p(String(y))];var v,g=[];if("undefined"===typeof y)return g;if(Array.isArray(s))v=s;else{var m=Object.keys(y);v=u?m.sort(u):m}for(var b=0;b<v.length;++b){var j=v[b];o&&null===y[j]||(g=Array.isArray(y)?g.concat(e(y[j],a(r,j),a,i,o,l,s,u,f,d,p,h)):g.concat(e(y[j],r+(f?"."+j:"["+j+"]"),a,i,o,l,s,u,f,d,p,h)))}return g};e.exports=function(e,t){var r=e,o=t?n.assign({},t):{};if(null!==o.encoder&&void 0!==o.encoder&&"function"!==typeof o.encoder)throw new TypeError("Encoder has to be a function.");var s="undefined"===typeof o.delimiter?c.delimiter:o.delimiter,u="boolean"===typeof o.strictNullHandling?o.strictNullHandling:c.strictNullHandling,f="boolean"===typeof o.skipNulls?o.skipNulls:c.skipNulls,d="boolean"===typeof o.encode?o.encode:c.encode,p="function"===typeof o.encoder?o.encoder:c.encoder,h="function"===typeof o.sort?o.sort:null,y="undefined"!==typeof o.allowDots&&o.allowDots,v="function"===typeof o.serializeDate?o.serializeDate:c.serializeDate,g="boolean"===typeof o.encodeValuesOnly?o.encodeValuesOnly:c.encodeValuesOnly;if("undefined"===typeof o.format)o.format=a.default;else if(!Object.prototype.hasOwnProperty.call(a.formatters,o.format))throw new TypeError("Unknown format option provided.");var m,b,j=a.formatters[o.format];"function"===typeof o.filter?r=(b=o.filter)("",r):Array.isArray(o.filter)&&(m=b=o.filter);var w,O=[];if("object"!==typeof r||null===r)return"";w=o.arrayFormat in i?o.arrayFormat:"indices"in o?o.indices?"indices":"repeat":"indices";var _=i[w];m||(m=Object.keys(r)),h&&m.sort(h);for(var A=0;A<m.length;++A){var k=m[A];f&&null===r[k]||(O=O.concat(l(r[k],k,_,u,f,d?p:null,b,h,y,v,j,g)))}var x=O.join(s),N=!0===o.addQueryPrefix?"?":"";return x.length>0?N+x:""}},674:function(e,t,r){"use strict";var n=r(636),a=Object.prototype.hasOwnProperty,i={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:n.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},o=function(e,t,r){if(e){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,i=/(\[[^[\]]*])/g,o=/(\[[^[\]]*])/.exec(n),c=o?n.slice(0,o.index):n,l=[];if(c){if(!r.plainObjects&&a.call(Object.prototype,c)&&!r.allowPrototypes)return;l.push(c)}for(var s=0;null!==(o=i.exec(n))&&s<r.depth;){if(s+=1,!r.plainObjects&&a.call(Object.prototype,o[1].slice(1,-1))&&!r.allowPrototypes)return;l.push(o[1])}return o&&l.push("["+n.slice(o.index)+"]"),function(e,t,r){for(var n=t,a=e.length-1;a>=0;--a){var i,o=e[a];if("[]"===o)i=(i=[]).concat(n);else{i=r.plainObjects?Object.create(null):{};var c="["===o.charAt(0)&&"]"===o.charAt(o.length-1)?o.slice(1,-1):o,l=parseInt(c,10);!isNaN(l)&&o!==c&&String(l)===c&&l>=0&&r.parseArrays&&l<=r.arrayLimit?(i=[])[l]=n:i[c]=n}n=i}return n}(l,t,r)}};e.exports=function(e,t){var r=t?n.assign({},t):{};if(null!==r.decoder&&void 0!==r.decoder&&"function"!==typeof r.decoder)throw new TypeError("Decoder has to be a function.");if(r.ignoreQueryPrefix=!0===r.ignoreQueryPrefix,r.delimiter="string"===typeof r.delimiter||n.isRegExp(r.delimiter)?r.delimiter:i.delimiter,r.depth="number"===typeof r.depth?r.depth:i.depth,r.arrayLimit="number"===typeof r.arrayLimit?r.arrayLimit:i.arrayLimit,r.parseArrays=!1!==r.parseArrays,r.decoder="function"===typeof r.decoder?r.decoder:i.decoder,r.allowDots="boolean"===typeof r.allowDots?r.allowDots:i.allowDots,r.plainObjects="boolean"===typeof r.plainObjects?r.plainObjects:i.plainObjects,r.allowPrototypes="boolean"===typeof r.allowPrototypes?r.allowPrototypes:i.allowPrototypes,r.parameterLimit="number"===typeof r.parameterLimit?r.parameterLimit:i.parameterLimit,r.strictNullHandling="boolean"===typeof r.strictNullHandling?r.strictNullHandling:i.strictNullHandling,""===e||null===e||"undefined"===typeof e)return r.plainObjects?Object.create(null):{};for(var c="string"===typeof e?function(e,t){for(var r={},n=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,o=t.parameterLimit===1/0?void 0:t.parameterLimit,c=n.split(t.delimiter,o),l=0;l<c.length;++l){var s,u,f=c[l],d=f.indexOf("]="),p=-1===d?f.indexOf("="):d+1;-1===p?(s=t.decoder(f,i.decoder),u=t.strictNullHandling?null:""):(s=t.decoder(f.slice(0,p),i.decoder),u=t.decoder(f.slice(p+1),i.decoder)),a.call(r,s)?r[s]=[].concat(r[s]).concat(u):r[s]=u}return r}(e,r):e,l=r.plainObjects?Object.create(null):{},s=Object.keys(c),u=0;u<s.length;++u){var f=s[u],d=o(f,c[f],r);l=n.merge(l,d,r)}return n.compact(l)}},675:function(e,t,r){"use strict";var n=r(17);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(0)),i=(0,n(r(18)).default)(a.default.createElement("path",{d:"M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),"KeyboardArrowUp");t.default=i},676:function(e,t,r){"use strict";var n=r(17);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(0)),i=(0,n(r(18)).default)(a.default.createElement("path",{d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"}),"KeyboardArrowDown");t.default=i},693:function(e,t,r){"use strict";r.r(t);var n=r(6),a=r(9),i=r(26),o=r(8),c=r(7),l=r(0),s=r.n(l),u=r(685),f=r(139),d=r(25),p=r(672),h=r.n(p),y=r(67);function v(e){var t={}.current_user;if(t){if(e._data._inited)return;e._data._inited=!0,t.branch.empty()?g("obj_delivery_state",[],e):g("manager",[t.ref],e,"cat.users")}}function g(e,t,r,n){var a=(r||this.props.scheme||{}).selection;if(a){var i=a.find({left_value:e});if(i||(i=a.add({left_value:e})),t.length){if(i.use=!0,i.left_value_type="path",i.right_value_type=n||this[e]._mgr.class_name,"obj_delivery_state"===e){var o,c=[],l=Object(y.a)(t);try{for(l.s();!(o=l.n()).done;){var s=o.value;"draft"===s?(c.push("\u0427\u0435\u0440\u043d\u043e\u0432\u0438\u043a"),c.push("\u041e\u0442\u043e\u0437\u0432\u0430\u043d")):"sent"===s?c.push("\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d"):"confirmed"===s?c.push("\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d"):"declined"===s?c.push("\u041e\u0442\u043a\u043b\u043e\u043d\u0435\u043d"):"template"===s&&c.push("\u0428\u0430\u0431\u043b\u043e\u043d")}}catch(u){l.e(u)}finally{l.f()}t=c}t.length>1?(i.comparison_type="in",i.right_value=t.join()):(i.comparison_type="eq",i.right_value=t[0])}else i.use=!1}}var m=r(686),b=r(675),j=r.n(b),w=r(676),O=r.n(w),_=r(82),A=r(11),k=r.n(A),x=function(e){Object(o.a)(r,e);var t=Object(c.a)(r);function r(){var e;Object(n.a)(this,r);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={selected:""},e}return Object(a.a)(r,[{key:"render",value:function(){var e=this,t=this.props,r=t.classes,n=t.hidden,a=t.height,i=t.reverseHide,o=t.handleNavigate,c=t.imgs,l=this.state.selected;return s.a.createElement("div",{className:r.root,style:{minHeight:a}},s.a.createElement(m.a,{size:"small",className:r.fab,onClick:i,style:{top:n?-16:0},title:n?"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u044d\u0441\u043a\u0438\u0437\u044b":"\u0421\u043a\u0440\u044b\u0442\u044c \u044d\u0441\u043a\u0438\u0437\u044b"},n?s.a.createElement(j.a,null):s.a.createElement(O.a,null)),!n&&c.map((function(t){var r=t.ref,n=t.svg,a=function(){return o("/builder/".concat(r))},i={};return s.a.createElement("div",{key:r,className:k()({rsvg_elm:!0,rsvg_selected:r===l}),ref:function(e){e&&(e.innerHTML=i.iface.scale_svg(n,88,22),e.firstChild.ondblclick=a)},onClick:function(){return e.setState({selected:r})},onDoubleClick:a})})))}}]),r}(s.a.Component),N=Object(_.a)((function(e){return{root:{width:"100%",position:"relative",paddingTop:2,maxHeight:180},fab:{position:"absolute",top:e.spacing(),right:e.spacing(2)}}}),{withTheme:!0})(x),E=new Map;E.set(!0,24),E.set(!1,90);var C=function(e){Object(o.a)(r,e);var t=Object(c.a)(r);function r(e,a){var o;Object(n.a)(this,r);return(o=t.call(this,e,a)).handleRowSelect=function(e){var t=e.selectedRow,r={};o.timer&&clearTimeout(o.timer),o.timer=setTimeout((function(){if(t&&o.prev_ref!==t.ref){if(o.state.hidden)return o.prev_ref=t.ref;var e=[];if(r.utils.is_data_obj(t))t.production.forEach((function(t){var r=t.characteristic,n=r.ref,a=r.svg;a&&e.push({ref:n,svg:a})})),o.prev_ref=t.ref,o.setState({imgs:e});else{var n=r.adapters.pouch.local.doc;n.get("doc.calc_order|".concat(t.ref)).then((function(t){var a=t.production;return a&&a.forEach((function(t){var n=t.characteristic;!r.utils.is_empty_guid(n)&&e.push("cat.characteristics|".concat(n))})),e.length?n.allDocs({keys:e,limit:e.length,include_docs:!0}):{rows:e}})).then((function(t){return t.rows.forEach((function(t){var r=t.id,n=t.doc;if(n&&n.svg){var a=e.indexOf(r);e[a]={ref:r.substr(20),svg:n.svg}}})),e.filter((function(e){return e.svg}))})).then((function(e){o.prev_ref=t.ref,o.setState({imgs:e})})).catch(r.record_log)}}else o.prev_ref="",o.setState({imgs:[]})}),300)},o.reverseHide=function(){var e=!o.state.hidden;({}).wsql.set_user_param("svgs_area_hidden",e),o.setState({hidden:e},(function(){if(!e&&o.prev_ref){var t=Object(i.a)(o).prev_ref;o.prev_ref="",o.handleRowSelect({selectedRow:{ref:t}})}}))},o.handlers=Object.assign({},o.props.handlers,{handleSchemeChange:v.bind(Object(i.a)(o))}),o.state={hidden:{}.wsql.get_user_param("svgs_area_hidden","boolean"),imgs:[]},o.timer=0,o.prev_ref="",o}return Object(a.a)(r,[{key:"render",value:function(){var e=this.props,t=e.windowHeight,r=e.windowWidth,n=e.location,a=this.state,i=a.hidden,o=a.imgs,c=this.handlers,l={windowHeight:t,windowWidth:r,height:(t>480?t-51:428)-E.get(i),width:r>800?r-(t<480?20:0):800},f=h.a.parse(n.search.replace("?",""));return[s.a.createElement(u.default,Object.assign({key:"list",_mgr:{}.doc.calc_order,_acl:"e",_ref:f.ref,handlers:c,onRowSelect:this.handleRowSelect,indexer:!0,show_search:!0},l)),s.a.createElement(N,{key:"svgs",hidden:i,imgs:o,height:E.get(i)-2,reverseHide:this.reverseHide,handleNavigate:c.handleNavigate})]}}]),r}(l.Component);C.rname="CalcOrderList";t.default=Object(f.a)(Object(d.withObj)(C))}}]);
//# sourceMappingURL=6.666dbf0e.chunk.js.map