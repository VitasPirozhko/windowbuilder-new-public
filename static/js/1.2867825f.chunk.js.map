{"version":3,"sources":["../node_modules/metadata-react/DynList/MenuPrint.js","../node_modules/@material-ui/icons/ChevronLeft.js","../node_modules/@material-ui/icons/AttachFile.js","../node_modules/metadata-react/DynList/DataListToolbar.js","../node_modules/@material-ui/icons/List.js","../node_modules/@material-ui/icons/AccountTree.js","../node_modules/metadata-react/DynList/DynList.js","../node_modules/metadata-react/DynList/index.js"],"names":["SubMenu","args","state","anchorEl","handleOpen","event","setState","currentTarget","handleClose","this","props","items","Icon","text","handlePrint","prefix","variant","React","createElement","IconButton","key","onClick","MenuItem","ListItemIcon","Menu","open","Boolean","anchorOrigin","vertical","horizontal","transformOrigin","onClose","map","v","ref","name","Component","MenuPrint","plates","_mgr","scheme","child_meta","printing_plates","then","groups","Map","plate","group","includes","substr","indexOf","trim","get","set","push","forEach","value","length","PrintIcon","index","ChevronLeft","propTypes","_interopRequireDefault","require","Object","defineProperty","exports","default","_react","_default","d","DataListToolbar","undefined","handleClick","handleRequestClose","handleSettingsToggle","settings_open","handleSettingsClose","handleSettingsOpen","classes","width","btns","end_btns","menu_items","toolbar2row","flat","show_flat","setting_in_menu","widthUpSm","isWidthUp","Toolbar","disableGutters","className","toolbar","selectionMode","Button","title","size","spaceLeft","handleSelect","denyAddDel","handleAdd","AddIcon","handleEdit","EditIcon","denyDel","handleRemove","RemoveIcon","flatChange","ListIcon","TreeIcon","standard_period","empty","disabled","DateRange","_obj","_fld","_meta","synonym","handleChange","handleFilterChange","flex","SchemeSettingsButtons","handleSchemeChange","show_search","show_variants","hide_btn","MoreVertIcon","SettingsIcon","handleAttachments","AttachIcon","SearchBox","defaultProps","compose","withStyles","withWidth","_extends","assign","target","i","arguments","source","prototype","hasOwnProperty","call","apply","DynList","context","handlers","fields","_mounted","set_default","columns","rx_columns","mode","rows","fakeRows","ranges","$p","CatScheme_settings","clear","onRowSelect","rowCount","selectedRow","loadMoreRows","startIndex","stopIndex","LIMIT","_owner","find_rows","scrollSetted","parent","increment","merged","nrange","range","Math","max","min","j","Promise","resolve","newState","no_rows","network_error","test","cachable","_direct_loaded","direct_load","selector","get_search_selector","search","_search","skip","top","sorting","utils","_find_rows_with_sort","alatable","docs","count","prnt","unshift","toJSON","delete","updateList","grid","selectCell","rowIdx","idx","sprm","limit","mango_selector","_raw","fromIndexer","data","Array","isArray","scroll","flag","catch","err","_timer","setTimeout","rowGetter","row","crange","dist","Infinity","cdist","abs","handleConfirmClose","confirm_text","handleInfoText","info_text","is_folder","force","is_empty_guid","handleIfaceState","component","handleMarkDeleted","_handleRemove","model","print","handleManagerChange","_ref","class_name","metadata","hierarchical","ov","cat","scheme_settings","get_scheme","indexer","navigator","onLine","find_rows_remote","adapters","pouch","doc","remote","_suffix","__opts","auth","username","password","append_selection","opts","method","credentials","headers","Authorization","btoa","unescape","encodeURIComponent","suffix","body","JSON","stringify","fetch","res","status","json","Error","statusText","_id","split","fn","sizes","RepParams","registerFilterChange","rowHeight","height","GridRenderer","others","LoadingMessage","show_grid","toolbar_props","dnr","Helmet","content","property","Confirm","handleOk","handleCancel","SchemeSettingsTabs","tabParams","ReactDataGrid","el","minHeight","minWidth","columnsWidth","cellNavigationMode","rowsCount","onCellDeSelected","onCellSelected","onRowDoubleClick","onGridSort","sortColumn","sortDirection","first_sorting","list_presentation","MDNRComponent","PropTypes","object","isRequired","_acl","string","bool","read_only","modal","contextTypes","withIface"],"mappings":"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","file":"static/js/1.2867825f.chunk.js","sourcesContent":["/**\n * Каскадер печатных форм\n *\n * @module MenuPrint\n *\n * Created by Evgeniy Malyarov on 15.05.2019.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport IconButton from '@material-ui/core/IconButton';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport PrintIcon from '@material-ui/icons/Print';\nimport ChevronLeft from '@material-ui/icons/ChevronLeft';\n\nclass SubMenu extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      anchorEl: null\n    };\n\n    this.handleOpen = event => {\n      this.setState({\n        anchorEl: event.currentTarget\n      });\n    };\n\n    this.handleClose = () => {\n      this.setState({\n        anchorEl: null\n      });\n    };\n  }\n\n  render() {\n    const {\n      props: {\n        items,\n        Icon,\n        text,\n        handlePrint,\n        prefix,\n        variant\n      },\n      state: {\n        anchorEl\n      }\n    } = this;\n    return [variant === 'button' ? /*#__PURE__*/React.createElement(IconButton, {\n      key: \"btn_open\",\n      onClick: this.handleOpen\n    }, /*#__PURE__*/React.createElement(Icon, null)) : /*#__PURE__*/React.createElement(MenuItem, {\n      key: `${prefix}_open`,\n      onClick: this.handleOpen\n    }, Icon && /*#__PURE__*/React.createElement(ListItemIcon, null, /*#__PURE__*/React.createElement(Icon, null)), text), /*#__PURE__*/React.createElement(Menu, {\n      key: `${prefix}_menu`,\n      open: Boolean(anchorEl),\n      anchorEl: anchorEl,\n      anchorOrigin: {\n        vertical: 'top',\n        horizontal: 'left'\n      },\n      transformOrigin: {\n        vertical: 'top',\n        horizontal: 'right'\n      },\n      onClose: this.handleClose\n    }, anchorEl && items.map(v => /*#__PURE__*/React.createElement(MenuItem, {\n      key: v.ref,\n      onClick: () => {\n        handlePrint(v);\n        this.handleClose();\n      }\n    }, v.name)))];\n  }\n\n}\n\nclass MenuPrint extends SubMenu {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      anchorEl: null,\n      plates: []\n    };\n  }\n\n  componentDidMount() {\n    const {\n      _mgr\n    } = this.props.scheme.child_meta();\n    _mgr && _mgr.printing_plates().then(plates => {\n      const groups = new Map();\n\n      for (const key in plates) {\n        const plate = plates[key];\n        const group = plate.name.includes('/') ? plate.name.substr(0, plate.name.indexOf('/')).trim() : 'Общее';\n\n        if (!groups.get(group)) {\n          groups.set(group, []);\n        }\n\n        groups.get(group).push(plate);\n      }\n\n      plates = [];\n      groups.forEach((value, name) => plates.push({\n        name,\n        value\n      }));\n      this.setState({\n        plates\n      });\n    });\n  }\n\n  render() {\n    const {\n      props: {\n        handlePrint,\n        variant\n      },\n      state: {\n        anchorEl,\n        plates\n      }\n    } = this;\n\n    if (plates.length === 1) {\n      return /*#__PURE__*/React.createElement(SubMenu, {\n        items: plates[0].value,\n        Icon: PrintIcon,\n        text: \"Печать\",\n        handlePrint: handlePrint,\n        prefix: \"root\",\n        variant: variant\n      });\n    }\n\n    return [variant === 'button' ? /*#__PURE__*/React.createElement(IconButton, {\n      key: \"btn_open\",\n      onClick: this.handleOpen\n    }, /*#__PURE__*/React.createElement(PrintIcon, null)) : /*#__PURE__*/React.createElement(MenuItem, {\n      key: \"prn_open\",\n      onClick: this.handleOpen\n    }, /*#__PURE__*/React.createElement(ListItemIcon, null, /*#__PURE__*/React.createElement(PrintIcon, null)), \"Печать\"), /*#__PURE__*/React.createElement(Menu, {\n      key: \"prn_menu\",\n      open: Boolean(anchorEl),\n      anchorEl: anchorEl,\n      anchorOrigin: {\n        vertical: 'top',\n        horizontal: 'left'\n      },\n      transformOrigin: {\n        vertical: 'top',\n        horizontal: 'right'\n      },\n      onClose: this.handleClose\n    }, anchorEl && plates.map((plate, index) => /*#__PURE__*/React.createElement(SubMenu, {\n      key: `prn_${index}`,\n      items: plate.value,\n      Icon: ChevronLeft,\n      text: plate.name,\n      handlePrint: handlePrint,\n      prefix: `prn_${index}`\n    })))];\n  }\n\n}\n\nMenuPrint.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  scheme: PropTypes.object.isRequired,\n  // значение настроек компоновки\n  handlePrint: PropTypes.func.isRequired,\n  // обработчик открытия диалога печати\n  variant: PropTypes.string // использовать IconButton вместо MenuItem\n\n} : {};\nexport default MenuPrint;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z\"\n}), 'ChevronLeft');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z\"\n}), 'AttachFile');\n\nexports.default = _default;","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport Button from '@material-ui/core/Button';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport AddIcon from '@material-ui/icons/AddCircleOutline';\nimport RemoveIcon from '@material-ui/icons/DeleteOutline';\nimport EditIcon from '@material-ui/icons/Edit';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport AttachIcon from '@material-ui/icons/AttachFile';\nimport SelectIcon from '@material-ui/icons/PlaylistAddCheck';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport TreeIcon from '@material-ui/icons/AccountTree';\nimport ListIcon from '@material-ui/icons/List';\nimport SchemeSettingsButtons from '../SchemeSettings/SchemeSettingsButtons';\nimport SearchBox from '../SchemeSettings/SearchBox';\nimport DateRange from '../SchemeSettings/DateRange';\nimport { compose } from 'redux';\nimport classnames from 'classnames';\nimport withStyles from '../Header/toolbar';\nimport withWidth, { isWidthUp } from '@material-ui/core/withWidth';\nimport MenuPrint from './MenuPrint';\n\nclass DataListToolbar extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      anchorEl: undefined,\n      open: false\n    };\n\n    this.handleClick = event => {\n      this.setState({\n        open: true,\n        anchorEl: event.currentTarget\n      });\n    };\n\n    this.handleRequestClose = () => {\n      this.setState({\n        open: false\n      });\n    };\n\n    this.handleSettingsToggle = () => {\n      const {\n        props\n      } = this;\n\n      if (props.settings_open) {\n        props.handleSettingsClose();\n      } else {\n        props.handleSettingsOpen();\n      }\n\n      this.handleRequestClose();\n    };\n  }\n\n  render() {\n    const {\n      props,\n      state\n    } = this;\n    const {\n      classes,\n      scheme,\n      width,\n      btns,\n      end_btns,\n      menu_items,\n      toolbar2row,\n      flat,\n      show_flat,\n      setting_in_menu\n    } = props;\n    const widthUpSm = isWidthUp('sm', width);\n    return [/*#__PURE__*/React.createElement(Toolbar, {\n      key: \"toolbar1\",\n      disableGutters: true,\n      className: classes.toolbar\n    }, props.selectionMode && /*#__PURE__*/React.createElement(Button, {\n      key: \"select\",\n      title: \"Выбрать из списка\",\n      size: \"small\",\n      variant: \"outlined\",\n      className: classes.spaceLeft,\n      onClick: props.handleSelect\n    }, \"Выбрать\"), !props.denyAddDel && /*#__PURE__*/React.createElement(IconButton, {\n      key: \"create\",\n      title: \"Создать объект\",\n      onClick: props.handleAdd\n    }, /*#__PURE__*/React.createElement(AddIcon, null)), /*#__PURE__*/React.createElement(IconButton, {\n      key: \"edit\",\n      title: \"Открыть форму объекта\",\n      onClick: props.handleEdit\n    }, /*#__PURE__*/React.createElement(EditIcon, null)), !props.denyAddDel && !props.denyDel && /*#__PURE__*/React.createElement(IconButton, {\n      key: \"del\",\n      title: \"Пометить на удаление\",\n      onClick: props.handleRemove\n    }, /*#__PURE__*/React.createElement(RemoveIcon, null)), show_flat && /*#__PURE__*/React.createElement(IconButton, {\n      key: \"flat\",\n      title: flat ? 'Включить иерархию' : 'Включить плоский список',\n      onClick: props.flatChange\n    }, flat ? /*#__PURE__*/React.createElement(ListIcon, null) : /*#__PURE__*/React.createElement(TreeIcon, null)), !scheme.standard_period.empty() && widthUpSm && /*#__PURE__*/React.createElement(IconButton, {\n      disabled: true\n    }, \"|\"), !scheme.standard_period.empty() && widthUpSm && /*#__PURE__*/React.createElement(DateRange, {\n      _obj: scheme,\n      _fld: 'date',\n      _meta: {\n        synonym: 'Период'\n      },\n      classes: classes,\n      handleChange: props.handleFilterChange\n    }), (!toolbar2row || widthUpSm) && btns\n    /* дополнительные кнопки */\n    , /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.flex\n    }), /*#__PURE__*/React.createElement(SchemeSettingsButtons, {\n      handleSettingsOpen: props.handleSettingsOpen,\n      handleSettingsClose: props.handleSettingsClose,\n      handleSchemeChange: props.handleSchemeChange,\n      handleFilterChange: props.handleFilterChange,\n      settings_open: props.settings_open,\n      classes: classes,\n      scheme: scheme,\n      show_search: props.show_search && (!toolbar2row || widthUpSm),\n      show_variants: props.show_variants,\n      hide_btn: !widthUpSm || setting_in_menu\n    }), (!toolbar2row || widthUpSm) && end_btns\n    /* дополнительные кнопки */\n    , /*#__PURE__*/React.createElement(IconButton, {\n      onClick: this.handleClick,\n      title: \"Дополнительно\"\n    }, /*#__PURE__*/React.createElement(MoreVertIcon, null)), /*#__PURE__*/React.createElement(Menu, {\n      anchorEl: state.anchorEl,\n      open: state.open,\n      onClose: this.handleRequestClose\n    }, (!widthUpSm || setting_in_menu) && /*#__PURE__*/React.createElement(MenuItem, {\n      onClick: this.handleSettingsToggle\n    }, /*#__PURE__*/React.createElement(ListItemIcon, null, /*#__PURE__*/React.createElement(SettingsIcon, null)), \"Настройки\"), props.handlePrint && /*#__PURE__*/React.createElement(MenuPrint, {\n      scheme: scheme,\n      handlePrint: props.handlePrint\n    }), props.handleAttachments && /*#__PURE__*/React.createElement(MenuItem, {\n      onClick: props.handleAttachments\n    }, /*#__PURE__*/React.createElement(ListItemIcon, null, /*#__PURE__*/React.createElement(AttachIcon, null)), \"Вложения\"), menu_items\n    /* дополнительные пункты меню */\n    )), toolbar2row && !widthUpSm && /*#__PURE__*/React.createElement(Toolbar, {\n      key: \"toolbar2\",\n      disableGutters: true,\n      className: classes.toolbar\n    }, btns\n    /* дополнительные кнопки */\n    , /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.flex\n    }), end_btns\n    /* дополнительные кнопки */\n    , /*#__PURE__*/React.createElement(SearchBox, {\n      scheme: scheme,\n      handleFilterChange: props.handleFilterChange,\n      isWidthUp: widthUpSm\n    }))];\n  }\n\n}\n\nDataListToolbar.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  selectionMode: PropTypes.bool,\n  // режим выбора из списка. Если истина - дополнительно рисум кнопку выбора\n  denyAddDel: PropTypes.bool,\n  // Запрет добавления и удаления строк (скрывает кнопки в панели, отключает обработчики)\n  handleSchemeChange: PropTypes.func.isRequired,\n  // обработчик при изменении настроек компоновки\n  scheme: PropTypes.object.isRequired,\n  // значение настроек компоновки\n  handleAdd: PropTypes.func,\n  // обработчик добавления объекта\n  handleEdit: PropTypes.func,\n  // обработчик открфтия формы редактора\n  handleRemove: PropTypes.func,\n  // обработчик удаления строки\n  handlePrint: PropTypes.func,\n  // обработчик открытия диалога печати\n  handleAttachments: PropTypes.func // обработчик открытия диалога присоединенных файлов\n\n} : {};\nDataListToolbar.defaultProps = {\n  show_search: true\n};\nexport default compose(withStyles, withWidth())(DataListToolbar);","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z\"\n}), 'List');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M22 11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3z\"\n}), 'AccountTree');\n\nexports.default = _default;","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\n/**\n *\n *\n * @module DynList\n *\n * Created by Evgeniy Malyarov on 27.03.2019.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport MDNRComponent from '../common/MDNRComponent';\nimport { withIface } from 'metadata-redux';\nimport ReactDataGrid from 'react-data-grid';\nimport LoadingMessage from '../DumbLoader/LoadingMessage';\nimport DataListToolbar from './DataListToolbar';\nimport SchemeSettingsTabs from '../SchemeSettings/SchemeSettingsTabs';\nimport Confirm from '../App/Confirm';\nimport { Helmet } from 'react-helmet';\nconst LIMIT = 50;\nconst ROW_HEIGHT = 33; //const OVERSCAN_ROW = 2;\n\nclass DynList extends MDNRComponent {\n  constructor(props, context) {\n    super(props, context);\n\n    this.flatChange = () => {\n      this.setState(({\n        flat\n      }) => ({\n        flat: !flat\n      }), this.handleFilterChange);\n    };\n\n    this.handleSchemeChange = scheme => {\n      const {\n        props: {\n          handlers,\n          _mgr\n        },\n        _meta: {\n          fields\n        },\n        _mounted\n      } = this;\n\n      if (!_mounted) {\n        return;\n      }\n\n      if (scheme) {\n        scheme.set_default();\n        handlers.handleSchemeChange && handlers.handleSchemeChange(scheme); // пересчитываем и перерисовываем динсписок\n\n        const columns = scheme.rx_columns({\n          mode: 'ts',\n          fields,\n          _mgr\n        });\n        this.handleFilterChange(scheme, columns);\n      }\n    };\n\n    this.handleFilterChange = (scheme, columns) => {\n      const {\n        state,\n        rows,\n        fakeRows,\n        ranges\n      } = this;\n\n      if (!(scheme instanceof $p.CatScheme_settings)) {\n        scheme = state.scheme;\n      }\n\n      if (!columns) {\n        columns = state.columns;\n      }\n\n      rows.clear();\n      fakeRows.clear();\n      ranges.length = 0;\n      this.onRowSelect({\n        scheme,\n        columns,\n        rowCount: 0,\n        selectedRow: null\n      }, () => {\n        this.loadMoreRows({\n          startIndex: 0,\n          stopIndex: LIMIT - 1\n        });\n      });\n    };\n\n    this.loadMoreRows = ({\n      startIndex,\n      stopIndex\n    }) => {\n      const {\n        props: {\n          _mgr,\n          _owner,\n          find_rows\n        },\n        state: {\n          scheme,\n          columns,\n          ref,\n          scrollSetted,\n          flat,\n          parent\n        },\n        rows,\n        fakeRows,\n        ranges\n      } = this;\n\n      if (startIndex < 0) {\n        startIndex = 0;\n      }\n\n      if (stopIndex < startIndex) {\n        stopIndex = startIndex;\n      }\n\n      let increment = stopIndex - startIndex;\n\n      if (!increment && rows.get(startIndex)) {\n        return;\n      }\n\n      const nrange = {\n        startIndex,\n        stopIndex\n      };\n      let merged;\n\n      for (const range of ranges) {\n        // если запрашиваемый диапазон внутри полученного ранее - выходим\n        if (range.stopIndex >= nrange.stopIndex && range.startIndex <= nrange.startIndex) {\n          return;\n        }\n\n        if (range.stopIndex >= nrange.startIndex && range.stopIndex <= nrange.stopIndex) {\n          range.stopIndex = Math.max(range.stopIndex, nrange.stopIndex);\n          merged = true;\n        }\n\n        if (range.startIndex <= nrange.stopIndex && range.startIndex >= nrange.startIndex) {\n          range.startIndex = Math.min(range.startIndex, nrange.startIndex);\n          merged = true;\n        }\n      }\n\n      if (!merged) {\n        ranges.push(nrange);\n      }\n\n      for (let j = startIndex; j < stopIndex; j++) {\n        fakeRows.set(j, {});\n      }\n\n      return Promise.resolve().then(() => {\n        const newState = {\n          no_rows: false,\n          network_error: null\n        };\n\n        if (scrollSetted) {\n          newState.scrollSetted = false;\n          newState.ref = '';\n        }\n\n        this.setState(newState); // в зависимости от типа кеширования...\n\n        if (/ram$/.test(_mgr.cachable) || _mgr._direct_loaded || _mgr.direct_load) {\n          // фильтруем в озу\n          const selector = _mgr.get_search_selector({\n            _obj: _owner ? _owner._obj || _owner.props && _owner.props._obj : null,\n            _meta: _owner ? _owner._meta : {},\n            _fld: _owner && _owner.props._fld,\n            search: scheme._search,\n            skip: startIndex,\n            top: increment + 1,\n            sorting: scheme.sorting,\n            flat,\n            parent\n          });\n\n          if (selector.top < LIMIT / 2) {\n            selector.top = LIMIT / 2;\n          }\n\n          return (_mgr.direct_load && !_mgr._direct_loaded ? _mgr.direct_load() : Promise.resolve()).then(() => $p.utils._find_rows_with_sort.call(_mgr, _mgr.alatable, selector)).then(({\n            docs,\n            count\n          }) => {\n            if (!flat && parent && !startIndex) {\n              let prnt = parent;\n\n              do {\n                docs.unshift(prnt.toJSON());\n                count++;\n                prnt = prnt.parent;\n              } while (!prnt.empty());\n            }\n\n            for (let j = startIndex; j <= stopIndex; j++) {\n              fakeRows.delete(j);\n            }\n\n            this.updateList(docs, startIndex, count);\n\n            if (!startIndex && docs.length) {\n              this.setState({\n                selectedRow: this.rows.get(0)\n              }, () => this.grid.selectCell({\n                rowIdx: 0,\n                idx: 0\n              }));\n            }\n          });\n        } else {\n          // выполняем запрос\n          const sprm = {\n            columns,\n            skip: startIndex,\n            limit: increment + 1,\n            _owner\n          };\n\n          if (sprm.limit < LIMIT / 2) {\n            sprm.limit = LIMIT / 2;\n          }\n\n          const selector = _mgr.mango_selector ? _mgr.mango_selector(scheme, sprm) : scheme.mango_selector(sprm); // если указано начальное значение списка, первый запрос делаем со ссылкой\n\n          if (ref && !scrollSetted) {\n            selector.ref = ref;\n          }\n\n          selector._raw = true;\n          return (find_rows ? find_rows(selector, scheme) : this.fromIndexer(selector)).then(data => {\n            if (!this._mounted) return;\n\n            for (let j = startIndex; j <= stopIndex; j++) {\n              fakeRows.delete(j);\n            }\n\n            if (Array.isArray(data)) {\n              this.updateList(data, startIndex);\n            } else {\n              const {\n                docs,\n                scroll,\n                flag,\n                count\n              } = data;\n              this.updateList(docs, startIndex, count);\n\n              if (ref && !scrollSetted) {\n                const newState = {\n                  scrollSetted: true,\n                  ref: ''\n                };\n                this.setState(newState, () => {\n                  //selectRow\n                  this.grid.selectCell({\n                    rowIdx: scroll,\n                    idx: 0\n                  });\n                });\n              }\n            }\n          }).catch(err => {\n            this.setState({\n              network_error: err\n            });\n\n            if (this._mounted) {\n              this._timer = setTimeout(this.handleFilterChange, 2600);\n            }\n          });\n        }\n      });\n    };\n\n    this.updateList = (data, startIndex, rowCount) => {\n      const {\n        rows\n      } = this; // обновляем массив результата\n\n      for (let i = 0; i < data.length; i++) {\n        // Append one because first row is header.\n        rows.set(i + startIndex, data[i]);\n      } // Обновить количество записей.\n\n\n      if (this._mounted) {\n        if (rowCount === undefined) {\n          rowCount = rows.size;\n        }\n\n        const newState = {\n          no_rows: !rowCount,\n          rowCount\n        };\n        this.setState(newState);\n      }\n    };\n\n    this.rowGetter = i => {\n      if (i < 0) {\n        return undefined;\n      }\n\n      const {\n        rows\n      } = this;\n      const row = rows.get(i);\n\n      if (!row) {\n        const {\n          fakeRows,\n          ranges,\n          state: {\n            rowCount\n          }\n        } = this; // todo: если i > диапазона, читаем вперёд, иначе - назад\n\n        if (!fakeRows.get(i)) {\n          if (rowCount && i > rowCount - LIMIT / 2) {\n            this.loadMoreRows({\n              startIndex: rowCount - LIMIT,\n              stopIndex: rowCount + 1\n            });\n          } else {\n            // ищем ближайший диапазон\n            let dist = Infinity;\n            let crange;\n\n            for (const range of ranges) {\n              const cdist = Math.min(Math.abs(range.startIndex - i), Math.abs(range.stopIndex - i));\n\n              if (cdist < dist) {\n                crange = range;\n                dist = cdist;\n              }\n            } // определяем направление\n\n\n            if (crange && i <= crange.startIndex) {\n              let lim = crange.startIndex - i;\n\n              if (lim < LIMIT) {\n                this.loadMoreRows({\n                  startIndex: crange.startIndex - LIMIT,\n                  stopIndex: crange.startIndex\n                });\n              } else {\n                this.loadMoreRows({\n                  startIndex: i - LIMIT / 2,\n                  stopIndex: i + LIMIT / 2 + 1\n                });\n              }\n            } else if (crange && i >= crange.stopIndex) {\n              let lim = i - crange.stopIndex;\n\n              if (lim < LIMIT) {\n                this.loadMoreRows({\n                  startIndex: crange.stopIndex,\n                  stopIndex: crange.stopIndex + LIMIT\n                });\n              } else {\n                this.loadMoreRows({\n                  startIndex: i - LIMIT / 2,\n                  stopIndex: i + LIMIT / 2\n                });\n              }\n            } else {\n              this.loadMoreRows({\n                startIndex: i,\n                stopIndex: i + LIMIT\n              });\n            }\n          }\n        }\n\n        return fakeRows.get(i);\n      }\n\n      return row;\n    };\n\n    this.handleSettingsOpen = () => {\n      this.setState({\n        settings_open: true\n      });\n    };\n\n    this.handleSettingsClose = () => {\n      this.setState({\n        settings_open: false\n      });\n    };\n\n    this.handleConfirmClose = () => {\n      this.setState({\n        confirm_text: ''\n      });\n    };\n\n    this.handleInfoText = info_text => {\n      if (typeof info_text !== 'string') {\n        info_text = '';\n      }\n\n      this.setState({\n        info_text\n      });\n    };\n\n    this.handleSelect = () => {\n      const {\n        selectedRow: row,\n        props: {\n          handlers,\n          _mgr\n        },\n        state: {\n          flat,\n          parent\n        },\n        _mounted\n      } = this;\n\n      if (!_mounted) {\n        return;\n      }\n\n      if (row) {\n        if (!flat && parent && row.is_folder) {\n          this.setState({\n            parent: row.ref == parent ? parent.parent : _mgr.get(row.ref)\n          }, () => this.handleFilterChange());\n        } else if (handlers.handleSelect) {\n          handlers.handleSelect(row, _mgr);\n        }\n      } else {\n        this.handleInfoText('Не выбрана строка');\n      }\n    };\n\n    this.handleAdd = event => {\n      const {\n        handlers,\n        _mgr\n      } = this.props;\n      handlers.handleAdd && handlers.handleAdd(_mgr, event);\n    };\n\n    this.handleEdit = force => () => {\n      const {\n        _meta,\n        selectedRow: row,\n        props: {\n          handlers,\n          _mgr\n        },\n        state: {\n          flat,\n          parent\n        }\n      } = this;\n\n      if (!row || $p.utils.is_empty_guid(row.ref)) {\n        return handlers.handleIfaceState({\n          component: '',\n          name: 'alert',\n          value: {\n            open: true,\n            text: 'Укажите строку для редактирования',\n            title: _meta.synonym\n          }\n        });\n      }\n\n      if (!force && !flat && parent && row.is_folder) {\n        this.setState({\n          parent: row.ref == parent ? parent.parent : _mgr.get(row.ref)\n        }, () => this.handleFilterChange());\n      } else if (handlers.handleEdit) {\n        handlers.handleEdit({\n          row,\n          ref: row.ref,\n          _mgr\n        });\n      }\n    };\n\n    this.handleRemove = () => {\n      const {\n        _meta,\n        selectedRow: row,\n        props: {\n          handlers,\n          _mgr\n        }\n      } = this;\n\n      if (!row || $p.utils.is_empty_guid(row.ref)) {\n        handlers.handleIfaceState({\n          component: '',\n          name: 'alert',\n          value: {\n            open: true,\n            text: 'Укажите строку для удаления',\n            title: _meta.synonym\n          }\n        });\n      } else if (handlers.handleMarkDeleted) {\n        this._handleRemove = () => {\n          this.setState({\n            confirm_text: ''\n          }, () => {\n            Promise.resolve().then(() => handlers.handleMarkDeleted({\n              row,\n              ref: row.ref,\n              _mgr\n            })).then(this.handleFilterChange).catch(err => this.setState({\n              network_error: err\n            }));\n          });\n        };\n\n        this.setState({\n          confirm_text: 'Удалить объект?'\n        });\n      }\n    };\n\n    this.handlePrint = model => {\n      const {\n        selectedRow: row,\n        props: {\n          _mgr\n        }\n      } = this;\n      row && _mgr.print(row.ref, model);\n    };\n\n    this.handleAttachments = () => {\n      const {\n        selectedRow: row,\n        props: {\n          handlers,\n          _mgr\n        }\n      } = this;\n      row && handlers.handleAttachments && handlers.handleAttachments(row, _mgr);\n    };\n\n    this.state = {\n      selectedRow: null,\n      scrollSetted: false,\n      rowCount: 0,\n      settings_open: false,\n      network_error: '',\n      no_rows: false,\n      ref: '',\n      scheme: null,\n      columns: []\n    };\n    /** Set of grid rows. */\n\n    this.rows = new Map();\n    this.fakeRows = new Map();\n    this.ranges = [];\n  }\n\n  componentDidMount() {\n    super.componentDidMount();\n    this.handleManagerChange(this.props);\n  }\n\n  // при изменении менеджера данных\n  handleManagerChange({\n    _mgr,\n    _meta,\n    _ref\n  }) {\n    const {\n      class_name\n    } = _mgr;\n    const {\n      flat,\n      parent,\n      _owner\n    } = this.props;\n    this._meta = _meta || _mgr.metadata();\n    this.show_flat = this._meta.hierarchical;\n    const newState = {\n      ref: _ref || '',\n      scrollSetted: false,\n      flat: flat || !this.show_flat,\n      parent: parent || _mgr.get()\n    };\n\n    if (!newState.flat && _owner && _owner.props) {\n      const ov = (_owner._obj || _owner.props && _owner.props._obj)[_owner.props._fld];\n\n      if (ov && !ov.empty()) {\n        newState.parent = ov.parent;\n      }\n    }\n\n    this.setState(newState);\n    $p.cat.scheme_settings.get_scheme(class_name).then(this.handleSchemeChange);\n  } // при изменении настроек или варианта компоновки\n\n\n  // получает набор банных из индексера либо спрашивает у менеджера, если оффлайн\n  fromIndexer(selector) {\n    const {\n      props: {\n        _mgr,\n        indexer\n      },\n      state: {\n        scheme\n      }\n    } = this;\n\n    if (!navigator.onLine || !scheme || !indexer) {\n      return _mgr.find_rows_remote(selector);\n    }\n\n    const {\n      remote: {\n        doc\n      },\n      props: {\n        _suffix\n      }\n    } = $p.adapters.pouch;\n    const {\n      username,\n      password\n    } = doc.__opts.auth;\n    scheme.append_selection(selector);\n    const opts = {\n      method: 'post',\n      credentials: 'include',\n      headers: {\n        Authorization: `Basic ${btoa(unescape(encodeURIComponent(username + ':' + password)))}`,\n        suffix: _suffix || '0'\n      },\n      body: JSON.stringify(selector)\n    };\n    return fetch('/r/_find', opts).then(res => {\n      if (res.status <= 201) {\n        return res.json();\n      } else {\n        return res.text().then(text => {\n          throw new Error(`${res.statusText}: ${text}`);\n        });\n      }\n    }).then(data => {\n      data.docs.forEach(doc => {\n        if (!doc.ref) {\n          doc.ref = doc._id.split('|')[1];\n          delete doc._id;\n        }\n      });\n      return data;\n    });\n  } // получает строку по индексу\n\n\n  // возвращает текущую строку динсписка\n  get selectedRow() {\n    const {\n      state: {\n        selectedRow\n      },\n      rows\n    } = this;\n    return typeof selectedRow === 'number' ? rows.get(selectedRow) : selectedRow;\n  } // обработчик выбора значения в списке\n\n\n  get ltitle() {\n    const {\n      _mgr\n    } = this.props;\n    return `${_mgr.metadata().list_presentation || _mgr.metadata().synonym} (список)`;\n  }\n\n  get Toolbar() {\n    return DataListToolbar;\n  }\n\n  onRowSelect(newState, fn) {\n    this.setState(newState, fn);\n    this.props.onRowSelect && this.props.onRowSelect(newState);\n  }\n\n  render() {\n    const {\n      state,\n      props,\n      context,\n      sizes,\n      handleFilterChange,\n      handleSchemeChange,\n      Toolbar,\n      show_flat\n    } = this;\n    const {\n      columns,\n      scheme,\n      confirm_text,\n      info_text,\n      settings_open,\n      rowCount,\n      flat\n    } = state;\n    const {\n      _mgr: {\n        RepParams\n      },\n      classes,\n      title,\n      registerFilterChange,\n      width,\n      height,\n      GridRenderer,\n      rowHeight,\n      ...others\n    } = props;\n\n    if (!scheme) {\n      return /*#__PURE__*/React.createElement(LoadingMessage, {\n        text: \"Чтение настроек компоновки...\"\n      });\n    } else if (!columns || !columns.length) {\n      return /*#__PURE__*/React.createElement(LoadingMessage, {\n        text: \"Ошибка настроек компоновки...\"\n      });\n    }\n\n    registerFilterChange && registerFilterChange(handleFilterChange);\n    const show_grid = !settings_open || sizes.height > 572;\n    const toolbar_props = {\n      scheme,\n      ...others,\n      settings_open,\n      flat,\n      show_flat,\n      flatChange: this.flatChange,\n      handleSelect: this.handleSelect,\n      handleAdd: this.handleAdd,\n      handleEdit: this.handleEdit(true),\n      handleRemove: this.handleRemove,\n      handlePrint: this.handlePrint,\n      //handleAttachments: this.handleAttachments,\n      handleSettingsOpen: this.handleSettingsOpen,\n      handleSettingsClose: this.handleSettingsClose,\n      handleSchemeChange,\n      handleFilterChange\n    };\n    return /*#__PURE__*/React.createElement(\"div\", null, !context.dnr && /*#__PURE__*/React.createElement(Helmet, {\n      key: \"helmet\",\n      title: title\n    }, /*#__PURE__*/React.createElement(\"meta\", {\n      name: \"description\",\n      content: \"Форма списка\"\n    }), /*#__PURE__*/React.createElement(\"meta\", {\n      property: \"og:title\",\n      content: title\n    }), /*#__PURE__*/React.createElement(\"meta\", {\n      property: \"og:description\",\n      content: \"Форма списка\"\n    })), // диалог предупреждений при удалении\n    confirm_text && /*#__PURE__*/React.createElement(Confirm, {\n      key: \"confirm\",\n      title: this._meta.synonym,\n      text: confirm_text,\n      handleOk: this._handleRemove,\n      handleCancel: this.handleConfirmClose,\n      open: true\n    }), // диалог информации\n    info_text && /*#__PURE__*/React.createElement(Confirm, {\n      key: \"info\",\n      title: this._meta.synonym,\n      text: info_text,\n      handleOk: this.handleInfoText,\n      handleCancel: this.handleInfoText,\n      open: true\n    }), /*#__PURE__*/React.createElement(Toolbar, _extends({\n      key: \"toolbar\"\n    }, toolbar_props)), // панель настроек компоновки\n    settings_open && /*#__PURE__*/React.createElement(SchemeSettingsTabs, {\n      key: \"settings\",\n      height: show_grid ? 272 : (sizes.height || 500) - 104,\n      scheme: scheme,\n      tabParams: RepParams && /*#__PURE__*/React.createElement(RepParams, {\n        scheme: scheme,\n        handleFilterChange: handleFilterChange\n      }),\n      handleSchemeChange: handleSchemeChange\n    }), /*#__PURE__*/React.createElement(ReactDataGrid, {\n      key: \"grid\",\n      ref: el => this.grid = el,\n      rowHeight: rowHeight || ROW_HEIGHT,\n      minHeight: sizes.height - 50 - (settings_open ? 320 : 0),\n      minWidth: context.dnr && Math.max(sizes.width, sizes.columnsWidth),\n      cellNavigationMode: \"changeRow\",\n      columns: columns,\n      rowGetter: this.rowGetter,\n      rowsCount: rowCount,\n      onCellDeSelected: () => this.onRowSelect({\n        selectedRow: null\n      }),\n      onCellSelected: v => this.onRowSelect({\n        selectedRow: this.rows.get(v.rowIdx) || v.rowIdx\n      }),\n      onRowDoubleClick: props.selectionMode ? this.handleSelect : this.handleEdit(),\n      onGridSort: (sortColumn, sortDirection) => {\n        scheme.first_sorting(sortColumn, sortDirection);\n        this.handleFilterChange();\n      }\n    }));\n  }\n\n}\n\nDynList.propTypes = {\n  // данные\n  _mgr: PropTypes.object.isRequired,\n  // Менеджер данных\n  _acl: PropTypes.string,\n  // Права на чтение-изменение\n  _meta: PropTypes.object,\n  // Описание метаданных. Если не указано, используем метаданные менеджера\n  _ref: PropTypes.string,\n  // Ссылка, на которую надо спозиционироваться\n  _owner: PropTypes.object,\n  // Поле - владелец. У него должны быть _obj, _fld и _meta\n  // а внутри _meta могут быть choice_params и choice_links\n  // настройки внешнего вида и поведения\n  selectionMode: PropTypes.bool,\n  // Режим выбора из списка. Если истина - дополнительно рисуем кнопку выбора\n  read_only: PropTypes.bool,\n  // Элемент только для чтения\n  denyAddDel: PropTypes.bool,\n  // Запрет добавления и удаления строк (скрывает кнопки в панели, отключает обработчики)\n  show_search: PropTypes.bool,\n  // Показывать поле поиска\n  show_variants: PropTypes.bool,\n  // Показывать список вариантов настройки динсписка\n  modal: PropTypes.bool,\n  // Показывать список в модальном диалоге\n  // Redux actions\n  handlers: PropTypes.object.isRequired // обработчики редактирования объекта\n\n};\nDynList.defaultProps = {\n  denyAddDel: false,\n  read_only: false,\n  minHeight: 220\n};\nDynList.contextTypes = {\n  dnr: PropTypes.object\n};\nexport default withIface(DynList);","import DynList from './DynList';\nexport default DynList;"],"sourceRoot":""}