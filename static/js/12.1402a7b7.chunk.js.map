{"version":3,"sources":["components/WorkCentersTask/MenuFillCutting.js","components/WorkCentersTask/MenuPrint.js","components/WorkCentersTask/ProgressDialog.js","components/WorkCentersTask/FrmObj.js","components/WorkCentersTask/Progress.js","components/RepMaterialsDemand/SelectOrder.js","../node_modules/@material-ui/icons/Work.js","components/WorkCentersTask/styles.js","components/WorkCentersTask/Report1D.js","../node_modules/@material-ui/icons/FormatColorFill.js","../node_modules/@material-ui/icons/Event.js","../node_modules/@material-ui/icons/RotateRight.js"],"names":["MenuFillCutting","React","Component","state","anchorEl","handleClick","event","this","setState","currentTarget","handleClose","handleFill1D","props","handleFillCutting","linear","handleFill1DClr","clr_only","handleFill2D","bilinear","handleFillAll","render","IconButton","aria-haspopup","title","onClick","Menu","open","Boolean","onClose","MenuItem","Transition","Slide","direction","MenuPrint","mode","handleCloseDialog","handle1D","handle2D","Dialog","fullScreen","TransitionComponent","Report1D","ProgressDialog","handleCancel","statuses","large","minheight","actions","Button","key","color","List","map","status","index","Progress","schemas","planning","demand","cuts_in","cutting","cuts_out","Space","classes","children","className","fullFlex","FrmObj","DataObj","constructor","context","super","handleOrder","row","_obj","fill_by_orders","then","forceUpdate","handlePlan","handleIfaceState","component","name","value","text","opts","fill_cutting","handleOptimize","onStep","handleOnStep","run","optimize","nom","characteristic","cut_row","$p","utils","_clone","some","elm","push","Object","assign","schemas_ready","componentDidMount","_mgr","match","get","params","ref","shouldComponentUpdate","load_production","prods","length","on","onDataChange","scheme_settings","cat","adapter","load_array","keys","local","templates","ts","renderFields","FormGroup","spaceLeft","DataField","_fld","fullWidth","height","_meta","_handlers","toolbar_props","posted","deleted","postable","metadata","deletable","h","Helmet","content","Tabs","onChange","Tab","label","DataObjToolbar","LoadingMessage","TabularSection","_tabular","minHeight","scheme","denyReorder","btns","disabled","SelectOrder","handleSelect","propTypes","PropTypes","object","_acl","string","read_only","handlers","isRequired","rname","withStyles","withIface","stat","rows","workpieces","products_len","workpieces_len","scraps_percent","scraps_len","userData","usefulscrap","toFixed","reduce","sum","val","completed","progress","buffer","Math","random","bottom","primary","empty","variant","valueBuffer","secondary","noPadding","theme","marginBottom","spacing","padding","handleTouchTap","preventDefault","handleRequestClose","find_rows","selector","remote","adapters","pouch","username","password","doc","__opts","auth","sort","date","headers","Headers","append","btoa","unescape","encodeURIComponent","_suffix","method","credentials","body","JSON","stringify","fetch","res","json","Error","statusText","data","docs","forEach","_id","split","noSpace","calc_order","selectionMode","denyAddDel","show_search","_interopRequireDefault","require","defineProperty","exports","default","_react","_default","createElement","d","root","width","marginLeft","marginRight","backgroundColor","palette","common","white","border","marginTop","canvas","Head","orders","Set","obj","add","Typography","presentation","Table","cell","TableBody","TableRow","TableCell","recipient","colSpan","Array","from","v","number_doc","join","NomTable","debit_credit_kinds","enm","fragments","characteristics","crows","cuts","record_kind","credit","debit","len","knifewidth","stick","Visualization","V1D","paper","Project","redraw","clear","i","workpiece","w","y","round","Path","segments","strokeColor","strokeScaling","strokeWidth","closed","a","b","curr","fillColor","Color","PointText","point","justification","fontSize","zoom_fit","view","update","bounds","activeLayer","strokeBounds","zoom","min","viewSize","center","hide_head","Fragment","fillOpacity"],"mappings":"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","file":"static/js/12.1402a7b7.chunk.js","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport IconFill from '@material-ui/icons/FormatColorFill';\r\n\r\nclass MenuFillCutting extends React.Component {\r\n  state = {\r\n    anchorEl: null,\r\n  };\r\n\r\n  handleClick = event => {\r\n    this.setState({ anchorEl: event.currentTarget });\r\n  };\r\n\r\n  handleClose = () => {\r\n    this.setState({ anchorEl: null });\r\n  };\r\n\r\n  handleFill1D = () => {\r\n    this.props.handleFillCutting({\r\n      linear: true,\r\n    });\r\n    this.handleClose();\r\n  };\r\n\r\n  handleFill1DClr = () => {\r\n    this.props.handleFillCutting({\r\n      linear: true,\r\n      clr_only: true,\r\n    });\r\n    this.handleClose();\r\n  };\r\n\r\n  handleFill2D = () => {\r\n    this.props.handleFillCutting({\r\n      bilinear: true,\r\n    });\r\n    this.handleClose();\r\n  };\r\n\r\n  handleFillAll = () => {\r\n    this.props.handleFillCutting({\r\n      bilinear: true,\r\n      linear: true,\r\n    });\r\n    this.handleClose();\r\n  };\r\n\r\n  render() {\r\n    const { anchorEl } = this.state;\r\n\r\n    return (\r\n      <div>\r\n        <IconButton\r\n          aria-haspopup=\"true\"\r\n          title=\"Заполнить\"\r\n          onClick={this.handleClick}\r\n        >\r\n          <IconFill/>\r\n        </IconButton>\r\n        <Menu\r\n          anchorEl={anchorEl}\r\n          open={Boolean(anchorEl)}\r\n          onClose={this.handleClose}\r\n        >\r\n          <MenuItem onClick={this.handleFill1D}>Линейный</MenuItem>\r\n          <MenuItem onClick={this.handleFill1DClr}>Линейный (только цвет)</MenuItem>\r\n          <MenuItem onClick={this.handleFill2D}>Двумерный</MenuItem>\r\n          <MenuItem onClick={this.handleFillAll}>Все виды</MenuItem>\r\n        </Menu>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nMenuFillCutting.propTypes = {\r\n  handleFillCutting: PropTypes.func.isRequired,\r\n};\r\n\r\n\r\nexport default MenuFillCutting;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport IconPrint from '@material-ui/icons/Print';\r\n//import IconClose from '@material-ui/icons/Close';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport Slide from '@material-ui/core/Slide';\r\n\r\nimport Report1D from './Report1D';\r\n\r\nfunction Transition(props) {\r\n  return <Slide direction=\"up\" {...props} />;\r\n}\r\n\r\nclass MenuPrint extends React.Component {\r\n  state = {\r\n    anchorEl: null,\r\n    mode: '',\r\n  };\r\n\r\n  handleClick = event => {\r\n    this.setState({anchorEl: event.currentTarget});\r\n  };\r\n\r\n  handleClose = () => {\r\n    this.setState({anchorEl: null});\r\n  };\r\n\r\n  handleCloseDialog = () => {\r\n    this.setState({mode: ''});\r\n  };\r\n\r\n  handle1D = () => {\r\n    this.setState({mode: '1D', anchorEl: null});\r\n  };\r\n\r\n\r\n  handle2D = () => {\r\n    this.setState({mode: '2D', anchorEl: null});\r\n  };\r\n\r\n\r\n  render() {\r\n    const { anchorEl, mode } = this.state;\r\n\r\n    return (\r\n      <div>\r\n        <IconButton\r\n          aria-haspopup=\"true\"\r\n          title=\"Печать\"\r\n          onClick={this.handleClick}\r\n        >\r\n          <IconPrint/>\r\n        </IconButton>\r\n        <Menu\r\n          anchorEl={anchorEl}\r\n          open={Boolean(anchorEl)}\r\n          onClose={this.handleClose}\r\n        >\r\n          <MenuItem onClick={this.handle1D}>Линейный</MenuItem>\r\n          <MenuItem onClick={this.handle2D}>Двумерный</MenuItem>\r\n        </Menu>\r\n        <Dialog\r\n          fullScreen\r\n          open={Boolean(mode)}\r\n          onClose={this.handleCloseDialog}\r\n          TransitionComponent={Transition}\r\n        >\r\n          <Report1D {...this.props}/>\r\n        </Dialog>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nMenuPrint.propTypes = {\r\n  _obj: PropTypes.object.isRequired,             // объект документа-задания\r\n};\r\n\r\n\r\nexport default MenuPrint;\r\n","/**\r\n * ### Визуализация процесса раскроя\r\n *\r\n * @module ProgressDialog\r\n *\r\n * Created by Evgeniy Malyarov on 27.09.2018.\r\n */\r\n\r\nimport React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from 'metadata-react/App/Dialog';\r\nimport List from '@material-ui/core/List';\r\n\r\nimport Progress from './Progress';\r\n\r\nclass ProgressDialog extends Component {\r\n\r\n  handleCancel = () => {\r\n\r\n  };\r\n\r\n  render() {\r\n\r\n    const {props: {statuses}, handleCancel} = this;\r\n\r\n    return <Dialog\r\n      open\r\n      large\r\n      minheight\r\n      title=\"Оптимизация раскроя\"\r\n      onClose={handleCancel}\r\n      actions={[\r\n        <Button key=\"cancel\" onClick={handleCancel} color=\"primary\">Закрыть</Button>\r\n      ]}\r\n    >\r\n      <List>\r\n        {statuses.map((status, index) => <Progress key={`p-${index}`} status={status}/>)}\r\n      </List>\r\n    </Dialog>;\r\n\r\n  }\r\n}\r\n\r\nProgressDialog.propTypes = {\r\n  statuses: PropTypes.array.isRequired,\r\n};\r\n\r\nexport default ProgressDialog;\r\n","/**\r\n * Форма документа Задание на производство\r\n *\r\n * @module FrmObj\r\n *\r\n * Created by Evgeniy Malyarov on 24.09.2018.\r\n */\r\n\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport {Helmet} from 'react-helmet';\r\nimport FormGroup from '@material-ui/core/FormGroup';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport IconEvent from '@material-ui/icons/Event';\r\nimport IconRotate from '@material-ui/icons/RotateRight';\r\nimport IconClose from '@material-ui/icons/Close';\r\n\r\nimport DataObj from 'metadata-react/FrmObj/DataObj';\r\nimport LoadingMessage from 'metadata-react/DumbLoader/LoadingMessage';\r\nimport DataObjToolbar from 'metadata-react/FrmObj/DataObjToolbar';\r\nimport DataField from 'metadata-react/DataField';\r\nimport TabularSection from 'metadata-react/TabularSection';\r\n\r\nimport withStyles from 'metadata-react/styles/paper600';\r\nimport {withIface} from 'metadata-redux';\r\n\r\nimport SelectOrder from '../RepMaterialsDemand/SelectOrder';\r\nimport MenuFillCutting from './MenuFillCutting';\r\nimport MenuPrint from './MenuPrint';\r\nimport ProgressDialog from './ProgressDialog';\r\n\r\nconst htitle = 'Задание на производство';\r\nconst description = 'Раскрой, потребность в материалах, файлы для станков';\r\nconst schemas = {\r\n  planning: 'c864d895-ac50-42be-8760-203cc46d208f',\r\n  demand: 'dab2c503-a426-4bf5-f083-fe6f1c64fbe5',\r\n  cuts_in: '187f9a40-94fc-4ad2-ee4c-26341b816ade',\r\n  cutting: '4fe15a0f-a6c2-442e-d8bb-7204c3085c4e',\r\n  cuts_out: '8fca797a-4e1c-4f8b-b0aa-1965b5e5e7db',\r\n};\r\n\r\nfunction Space({classes, children}) {\r\n  return [<div key=\"space\" className={classes.fullFlex} />, ...children];\r\n}\r\n\r\nclass FrmObj extends DataObj {\r\n\r\n  constructor(props, context) {\r\n    super(props, context);\r\n    Object.assign(this.state, {\r\n      index: 0,\r\n      schemas_ready: typeof schemas.planning === 'object',\r\n      statuses: [],\r\n      run: false,\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    const {_mgr, match} = this.props;\r\n\r\n    _mgr.get(match.params.ref, 'promise')\r\n      .then((_obj) => {\r\n        this.setState({_obj}, () => this.shouldComponentUpdate(this.props));\r\n        return _obj.load_production();\r\n      })\r\n      .then((prods) => prods.length && this.forceUpdate());\r\n\r\n    _mgr.on('update', this.onDataChange);\r\n\r\n    if(!this.state.schemas_ready) {\r\n      const {scheme_settings} = $p.cat;\r\n      const {adapter} = scheme_settings;\r\n      adapter.load_array(scheme_settings, Object.keys(schemas).map((ref) => schemas[ref]), false, adapter.local.templates)\r\n        .then(() => {\r\n          for(const ts in schemas) {\r\n            schemas[ts] = scheme_settings.get(schemas[ts]);\r\n          }\r\n          this.setState({schemas_ready: true});\r\n        });\r\n    }\r\n  }\r\n\r\n  handleOrder = (row) => {\r\n    const {_obj} = this.state;\r\n    _obj && _obj.fill_by_orders([row])\r\n      .then(() => this.forceUpdate());\r\n  };\r\n\r\n  handlePlan = () => {\r\n    this.props.handleIfaceState({\r\n      component: '',\r\n      name: 'alert',\r\n      value: {open: true, title: 'Заполнить по плану', text: 'Сервис планирования не подключен'}});\r\n  };\r\n\r\n  handleFillCutting = (opts) => {\r\n    const {_obj} = this.state;\r\n    _obj && _obj.fill_cutting(opts)\r\n      .then(() => this.forceUpdate());\r\n  };\r\n\r\n  handleOptimize = (opts = {}) => {\r\n    const {_obj} = this.state;\r\n    opts.onStep = this.handleOnStep;\r\n    this.setState({statuses: [], run: true});\r\n    _obj && _obj.optimize(opts)\r\n      .then(() => this.setState({run: false}));\r\n  };\r\n\r\n  // вызывается из раскроя\r\n  handleOnStep = (status) => {\r\n    const {nom, characteristic} = status.cut_row;\r\n    const statuses = $p.utils._clone(this.state.statuses);\r\n    let row;\r\n    if(!statuses.some((elm) => {\r\n      if(elm.nom === nom && elm.characteristic === characteristic) {\r\n        row = elm;\r\n        return true;\r\n      }\r\n    })) {\r\n      row = {nom, characteristic};\r\n      statuses.push(row);\r\n    }\r\n    Object.assign(row, status);\r\n\r\n    this.setState({statuses});\r\n  };\r\n\r\n\r\n  renderFields(_obj, classes) {\r\n    return (\r\n      <FormGroup key=\"props\" className={classes.spaceLeft}>\r\n        <FormGroup row>\r\n          <DataField _obj={_obj} _fld=\"number_doc\"/>\r\n          <DataField _obj={_obj} _fld=\"date\"/>\r\n          <DataField _obj={_obj} _fld=\"responsible\"/>\r\n        </FormGroup>\r\n        <FormGroup row>\r\n          <DataField _obj={_obj} _fld=\"key\"/>\r\n          <DataField _obj={_obj} _fld=\"recipient\"/>\r\n          <DataField _obj={_obj} _fld=\"biz_cuts\"/>\r\n        </FormGroup>\r\n        <DataField _obj={_obj} _fld=\"note\" fullWidth/>\r\n      </FormGroup>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      props: {_mgr, classes, height},\r\n      state: {_obj, _meta, index, schemas_ready, run, statuses},\r\n      _handlers} = this;\r\n    const toolbar_props = Object.assign({\r\n      posted: _obj && _obj.posted,\r\n      deleted: _obj && _obj.deleted,\r\n      postable: !!(_meta.posted || _mgr.metadata('posted')),\r\n      deletable: false,\r\n    }, _handlers);\r\n    const h = height - 48;\r\n\r\n    return _obj ? [\r\n        <Helmet key=\"helmet\" title={htitle}>\r\n          <meta name=\"description\" content={description} />\r\n        </Helmet>,\r\n\r\n        <Tabs key=\"tabs\" value={index} onChange={(event, index) => this.setState({index})}>\r\n          <Tab label=\"Шапка\"/>\r\n          <Tab label=\"План\"/>\r\n          <Tab label=\"Материалы\"/>\r\n          <Tab label=\"Обрезь вход\"/>\r\n          <Tab label=\"Раскрой\"/>\r\n          <Tab label=\"Обрезь выход\"/>\r\n          <Space classes={classes}>\r\n            <MenuPrint key=\"fprint\" _obj={_obj}/>\r\n            <IconButton key=\"fclose\" title=\"Закрыть форму\" onClick={_handlers.handleClose}>\r\n              <IconClose/>\r\n            </IconButton>\r\n          </Space>\r\n        </Tabs>,\r\n\r\n        index === 0 && <DataObjToolbar key=\"toolbar\" {...toolbar_props} />,\r\n\r\n        index === 0 && this.renderFields(_obj, classes),\r\n\r\n        index !== 0 && !schemas_ready && <LoadingMessage />,\r\n\r\n        index === 1 && schemas_ready && <TabularSection\r\n          key=\"planning\"\r\n          _obj={_obj}\r\n          _tabular=\"planning\"\r\n          minHeight={h}\r\n          scheme={schemas.planning}\r\n          denyReorder\r\n          btns={[\r\n            <IconButton key=\"a_sep1\" disabled>|</IconButton>,\r\n            <SelectOrder key=\"a_ord\" handleSelect={this.handleOrder}/>,\r\n            <IconButton key=\"a_plan\" title=\"Заполнить по плану\" onClick={this.handlePlan}>\r\n              <IconEvent/>\r\n            </IconButton>\r\n          ]}\r\n        />,\r\n\r\n        index === 2 && schemas_ready && <TabularSection\r\n          key=\"demand\"\r\n          _obj={_obj}\r\n          _tabular=\"demand\"\r\n          minHeight={h}\r\n          scheme={schemas.demand}\r\n          denyReorder\r\n        />,\r\n\r\n        index === 3 && schemas_ready && <TabularSection\r\n          key=\"cuts_in\"\r\n          _obj={_obj}\r\n          _tabular=\"cuts\"\r\n          minHeight={h}\r\n          scheme={schemas.cuts_in}\r\n          denyReorder\r\n        />,\r\n\r\n        index === 4 && schemas_ready && <TabularSection\r\n          key=\"cutting\"\r\n          _obj={_obj}\r\n          _tabular=\"cutting\"\r\n          minHeight={h}\r\n          scheme={schemas.cutting}\r\n          denyReorder\r\n          btns={[\r\n            <IconButton key=\"a_sep1\" disabled>|</IconButton>,\r\n            <MenuFillCutting key=\"a_fill_cut\" handleFillCutting={this.handleFillCutting}/>,\r\n            <IconButton key=\"a_run\" title=\"Оптимизировать раскрой\" onClick={this.handleOptimize}>\r\n              <IconRotate/>\r\n            </IconButton>,\r\n          ]}\r\n        />,\r\n\r\n        index === 5 && schemas_ready && <TabularSection\r\n          key=\"cuts_out\"\r\n          _obj={_obj}\r\n          _tabular=\"cuts\"\r\n          minHeight={h}\r\n          scheme={schemas.cuts_out}\r\n          denyReorder\r\n        />,\r\n\r\n        run && <ProgressDialog key=\"statuses\" statuses={statuses} />,\r\n\r\n      ]\r\n      :\r\n      <LoadingMessage />;\r\n  }\r\n}\r\n\r\nFrmObj.propTypes = {\r\n  _mgr: PropTypes.object,             // DataManager, с которым будет связан компонент\r\n  _acl: PropTypes.string,             // Права на чтение-изменение\r\n  _meta: PropTypes.object,            // Здесь можно переопределить метаданные\r\n\r\n  read_only: PropTypes.object,        // Элемент только для чтения\r\n\r\n  handlers: PropTypes.object.isRequired, // обработчики редактирования объекта\r\n};\r\n\r\nFrmObj.rname = 'FrmObj';\r\n\r\nexport default withStyles(withIface(FrmObj));\r\n","/**\r\n *\r\n *\r\n * @module Progress\r\n *\r\n * Created by Evgeniy Malyarov on 27.09.2018.\r\n */\r\n\r\nimport React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport LinearProgress from '@material-ui/core/LinearProgress';\r\n\r\nimport {withStyles} from '@material-ui/styles';\r\n\r\nconst styles = (theme) => ({\r\n  bottom: {\r\n    marginBottom: theme.spacing(2),\r\n  },\r\n  noPadding: {\r\n    padding: 0,\r\n  }\r\n});\r\n\r\nexport function stat(status) {\r\n  const {rows, workpieces, products_len, workpieces_len, scraps_percent, scraps_len, userData: {usefulscrap}} = status;\r\n  return `${(products_len / 1000).toFixed(1)}м, ${rows.length}шт, Заготовок: ${\r\n    (workpieces_len / 1000).toFixed(1)}м, ${workpieces.length}шт, Обрезь: ${\r\n    (scraps_len / 1000).toFixed(1)}м, ${workpieces.reduce((sum, val) => val > usefulscrap ? sum + 1 : sum, 0)}шт, Отходы: ${\r\n    ((workpieces_len - products_len - scraps_len) / 1000).toFixed(1)}м, ${scraps_percent.toFixed(1)}%`;\r\n}\r\n\r\nclass Progress extends Component {\r\n\r\n  render() {\r\n    const {status, classes} = this.props;\r\n    const completed = status.progress * 100;\r\n    const buffer = completed + Math.random() * 6;\r\n\r\n    return <div className={classes.bottom}>\r\n      <ListItemText primary={`${status.nom.name}${status.characteristic.empty() ? '' : ' ' + status.characteristic.name}`}/>\r\n      <LinearProgress color=\"secondary\" variant=\"buffer\" value={completed} valueBuffer={buffer}/>\r\n      <ListItemText secondary={stat(status)} className={classes.noPadding}/>\r\n    </div>;\r\n  }\r\n}\r\n\r\nProgress.propTypes = {\r\n  status: PropTypes.object.isRequired,\r\n  classes: PropTypes.object.isRequired,\r\n};\r\n\r\nexport default withStyles(styles)(Progress);\r\n","import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport IconWork from '@material-ui/icons/Work';\r\n//import Dialog from 'metadata-react/DnR/Dialog';\r\nimport Dialog from 'metadata-react/App/Dialog';\r\nimport DataList from 'metadata-react/DynList/DynList';\r\n\r\nclass SelectOrder extends Component {\r\n\r\n  constructor(props, context) {\r\n    super(props, context);\r\n    this.state = {open: false};\r\n  }\r\n\r\n  handleTouchTap = (event) => {\r\n    // This prevents ghost click.\r\n    event.preventDefault();\r\n\r\n    this.setState({open: true});\r\n  };\r\n\r\n  handleRequestClose = () => {\r\n    this.setState({open: false});\r\n  };\r\n\r\n  handleSelect = (row, _mgr) => {\r\n    this.handleRequestClose();\r\n    this.props.handleSelect(row, _mgr);\r\n  };\r\n\r\n  find_rows = (selector) => {\r\n    const {remote, props} = $p.adapters.pouch;\r\n    const {username, password} = remote.doc.__opts.auth;\r\n\r\n    selector.sort = [{date: 'desc'}];\r\n\r\n    const headers = new Headers();\r\n    headers.append('Authorization', 'Basic ' + btoa(unescape(encodeURIComponent(username + ':' + password))));\r\n    headers.append('suffix', props._suffix || '0');\r\n    const opts = {\r\n      method: 'post',\r\n      credentials: 'include',\r\n      headers,\r\n      body: JSON.stringify(selector)\r\n    };\r\n\r\n    return fetch('/r/_find', opts)\r\n      .then((res) => {\r\n        if(res.status <= 201) {\r\n          return res.json();\r\n        }\r\n        else {\r\n          return res.text()\r\n            .then((text) => {\r\n              throw new Error(`${res.statusText}: ${text}`);\r\n            });\r\n        }\r\n      })\r\n      .then((data) => {\r\n        data.docs.forEach((doc) => {\r\n          doc.ref = doc._id.split('|')[1];\r\n          delete doc._id;\r\n        });\r\n        return data;\r\n      });\r\n  };\r\n\r\n  render() {\r\n\r\n    const {handleSelect, props, state} = this;\r\n\r\n    return (\r\n      <div>\r\n        <IconButton title=\"Добавить из заказа\" onClick={this.handleTouchTap}>\r\n          <IconWork/>\r\n        </IconButton>\r\n        {state.open && <Dialog\r\n          open\r\n          noSpace\r\n          large\r\n          //initFullScreen\r\n          title=\"Добавить из заказа\"\r\n          onClose={this.handleRequestClose}\r\n        >\r\n          <DataList\r\n            height={480}\r\n            _mgr={$p.doc.calc_order}\r\n            _acl={props._acl}\r\n            handlers={{handleSelect}}\r\n            //find_rows={this.find_rows}\r\n            selectionMode\r\n            denyAddDel\r\n            //show_variants\r\n            show_search\r\n          />\r\n        </Dialog>}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nSelectOrder.propTypes = {\r\n  handleSelect: PropTypes.func.isRequired,\r\n  _acl: PropTypes.object\r\n};\r\nexport default SelectOrder;\r\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M20 6h-4V4c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-6 0h-4V4h4v2z\"\n}), 'Work');\n\nexports.default = _default;","/**\r\n * ### Карточка покупателя\r\n * стили оформления\r\n *\r\n * Created by Evgeniy Malyarov on 14.03.2018.\r\n */\r\n\r\nimport {withStyles} from '@material-ui/styles';\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: '80vw',\r\n    marginLeft: 'auto',\r\n    marginRight: 'auto',\r\n    '@media print': {\r\n      width: '190mm',\r\n      backgroundColor: theme.palette.common.white\r\n    },\r\n    '& td': {\r\n      padding: theme.spacing() / 2,\r\n      border: '1px solid rgba(224, 224, 224, 1)'\r\n    },\r\n  },\r\n  row: {\r\n    height: 'inherit',\r\n  },\r\n  nom: {\r\n    marginTop: theme.spacing(2),\r\n  },\r\n  data: {\r\n    marginBottom: theme.spacing(2),\r\n  },\r\n  canvas: {\r\n    width: '100%',\r\n  }\r\n});\r\n\r\nexport default withStyles(styles);\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\n//import TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\n\r\nimport withStyles from './styles';\r\nimport {stat} from './Progress';\r\n\r\n\r\nfunction Report1D({hide_head, ...props}) {\r\n  return <div className={props.classes.root}>\r\n    {!hide_head && <Head key=\"head\" {...props}/>}\r\n    <div className={props.classes.data} key=\"table\"><NomTable {...props}/></div>\r\n  </div>;\r\n}\r\n\r\n// рисует шапку\r\nfunction Head({_obj, classes}) {\r\n  const orders = new Set();\r\n  _obj.planning.forEach(({obj}) => orders.add(obj.calc_order));\r\n  return <div>\r\n    <Typography variant=\"headline\">{_obj.presentation}</Typography>\r\n      <Table classes={{cell: classes.cell}}>\r\n        <TableBody>\r\n          <TableRow className={classes.row}>\r\n            <TableCell><Typography variant=\"subtitle1\">Участок</Typography></TableCell>\r\n            <TableCell>{_obj.key.presentation}</TableCell>\r\n            <TableCell><Typography variant=\"subtitle1\">Получатель</Typography></TableCell>\r\n            <TableCell>{_obj.recipient.presentation}</TableCell>\r\n          </TableRow>\r\n          <TableRow className={classes.row}>\r\n            <TableCell><Typography variant=\"subtitle1\">Заказы</Typography></TableCell>\r\n            <TableCell colSpan={3}>{Array.from(orders).map((v) => v.number_doc).sort().join(', ')}</TableCell>\r\n          </TableRow>\r\n        </TableBody>\r\n      </Table>\r\n  </div>;\r\n}\r\n\r\n// рисует таблицу по номенклатуре\r\nfunction NomTable({_obj, classes}) {\r\n  const res = [];\r\n  const {debit_credit_kinds} = $p.enm;\r\n\r\n  // бежим по свёрнутой табчасти раскроя\r\n  const fragments = _obj.fragments();\r\n  fragments.forEach((characteristics, nom) => {\r\n    for(const [characteristic] of characteristics) {\r\n      const crows = _obj.cutting.find_rows({nom, characteristic});\r\n      const cuts_in = _obj.cuts.find_rows({record_kind: debit_credit_kinds.credit, nom, characteristic});\r\n      const cuts_out = _obj.cuts.find_rows({record_kind: debit_credit_kinds.debit, nom, characteristic});\r\n\r\n      const products_len = crows.reduce((sum, row) => sum + row.len, 0);\r\n      const workpieces_len = cuts_in.reduce((sum, row) => sum + row.len, 0);\r\n      const scraps_len = cuts_out.reduce((sum, row) => sum + row.len, 0);\r\n      const knifewidth = nom.knifewidth || 7;\r\n      const workpieces = cuts_in.map(({len, stick}) => {\r\n        crows.forEach((row) => {\r\n          if(stick === row.stick) {\r\n            len -= (row.len + knifewidth);\r\n          }\r\n        });\r\n        return len > 0 ? len : 0;\r\n      });\r\n      const scraps_percent = (workpieces_len - products_len - scraps_len - crows.length * knifewidth) * 100 / workpieces_len;\r\n\r\n      const status = {\r\n        rows: crows,\r\n        cuts_in,\r\n        workpieces,\r\n        products_len,\r\n        workpieces_len,\r\n        scraps_len,\r\n        scraps_percent: scraps_percent > 0 ? scraps_percent : 0,\r\n        userData: {usefulscrap: 600, knifewidth}\r\n      };\r\n\r\n      res.push(<div key={`${nom.ref}-${characteristic.ref}`} className={classes.nom}>\r\n        <Typography variant=\"h6\">{nom.name + (characteristic.empty() ? '' : ` ${characteristic.name}`)}</Typography>\r\n        <Typography variant=\"subtitle1\">{stat(status)}</Typography>\r\n        <Visualization classes={classes} status={status}/>\r\n      </div>);\r\n    }\r\n  });\r\n  return res;\r\n}\r\n\r\nclass V1D extends paper.Project {\r\n\r\n  redraw({userData, cuts_in, rows}) {\r\n\r\n    this.clear();\r\n\r\n    let x=0, h=88;\r\n\r\n    for (let i = 0; i < cuts_in.length; i++) {\r\n\r\n      const workpiece = cuts_in[i];\r\n      const w = workpiece.len;\r\n      const y = Math.round(h * 1.3) * i;\r\n\r\n      new paper.Path({\r\n        segments: [[x, y], [x + w, y], [x + w, y + h], [x, y + h]],\r\n        strokeColor: 'grey',\r\n        strokeScaling: false,\r\n        strokeWidth: 1,\r\n        closed: true\r\n      });\r\n\r\n      const res = [];\r\n      rows.forEach(({stick, len}) => {\r\n        if(stick === workpiece.stick){\r\n          res.push(len);\r\n        }\r\n      });\r\n      res.sort((a, b) => b - a);\r\n      res.reduce((sum, curr) => {\r\n        new paper.Path({\r\n          segments: [[x + sum + h / 2, y + 4], [x + sum + curr - h / 2, y + 4], [x + sum + curr, y + h - 4], [x + sum, y + h - 4]],\r\n          fillColor: new paper.Color(Math.random() * 0.1 + 0.7, Math.random() * 0.2 + 0.8, Math.random() * 0.1 + 0.88),\r\n          closed: true\r\n        });\r\n        new paper.PointText({\r\n          point: [x + sum + curr / 2, y + 24 + h / 2],\r\n          content: curr,\r\n          fillColor: 'black',\r\n          justification: 'center',\r\n          fontSize: 72\r\n        });\r\n        return sum + curr + userData.knifewidth;\r\n      }, 0);\r\n\r\n    }\r\n\r\n    this.zoom_fit();\r\n    this.view.update();\r\n  }\r\n\r\n  zoom_fit () {\r\n\r\n    var bounds = this.activeLayer && this.activeLayer.strokeBounds;\r\n\r\n    if(bounds && bounds.height && bounds.width){\r\n      this.view.zoom = Math.min((this.view.viewSize.height - 8) / bounds.height, (this.view.viewSize.width - 8) / bounds.width);\r\n      this.view.center = bounds.center;\r\n    }\r\n  }\r\n\r\n}\r\n\r\n// рисует результат раскроя\r\nfunction Visualization({status, classes}) {\r\n  return <canvas className={classes.canvas} ref={(canvas) => {\r\n    if(canvas) {\r\n      canvas.height = status.cuts_in.length * 27 * canvas.width / 1530;\r\n      const scheme = new V1D(canvas);\r\n      scheme.redraw(status);\r\n    }\r\n  }}/>;\r\n}\r\n\r\nReport1D.propTypes = {\r\n  classes: PropTypes.object.isRequired,\r\n  _obj: PropTypes.object.isRequired,\r\n  hide_head: PropTypes.bool,\r\n};\r\n\r\nNomTable.propTypes = {\r\n  _obj: PropTypes.object.isRequired,\r\n  classes: PropTypes.object.isRequired,\r\n};\r\n\r\nHead.propTypes = {\r\n  _obj: PropTypes.object.isRequired,\r\n  classes: PropTypes.object.isRequired,\r\n};\r\n\r\nVisualization.propTypes = {\r\n  status: PropTypes.object.isRequired,\r\n  classes: PropTypes.object.isRequired,\r\n};\r\n\r\n\r\nexport default withStyles(Report1D);\r\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(_react.default.Fragment, null, _react.default.createElement(\"path\", {\n  d: \"M16.56 8.94L7.62 0 6.21 1.41l2.38 2.38-5.15 5.15c-.59.59-.59 1.54 0 2.12l5.5 5.5c.29.29.68.44 1.06.44s.77-.15 1.06-.44l5.5-5.5c.59-.58.59-1.53 0-2.12zM5.21 10L10 5.21 14.79 10H5.21zM19 11.5s-2 2.17-2 3.5c0 1.1.9 2 2 2s2-.9 2-2c0-1.33-2-3.5-2-3.5z\"\n}), _react.default.createElement(\"path\", {\n  fillOpacity: \".36\",\n  d: \"M0 20h24v4H0z\"\n})), 'FormatColorFill');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z\"\n}), 'Event');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)(_react.default.createElement(\"path\", {\n  d: \"M15.55 5.55L11 1v3.07C7.06 4.56 4 7.92 4 12s3.05 7.44 7 7.93v-2.02c-2.84-.48-5-2.94-5-5.91s2.16-5.43 5-5.91V10l4.55-4.45zM19.93 11c-.17-1.39-.72-2.73-1.62-3.89l-1.42 1.42c.54.75.88 1.6 1.02 2.47h2.02zM13 17.9v2.02c1.39-.17 2.74-.71 3.9-1.61l-1.44-1.44c-.75.54-1.59.89-2.46 1.03zm3.89-2.42l1.42 1.41c.9-1.16 1.45-2.5 1.62-3.89h-2.02c-.14.87-.48 1.72-1.02 2.48z\"\n}), 'RotateRight');\n\nexports.default = _default;"],"sourceRoot":""}